@model IEnumerable<CardAuction.Models.tAuctionItem>

@{
    ViewBag.Title = "競標商品一覽";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section styles{
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css" integrity="sha512-10/jx2EXwxxWqCLX/hHth/vu2KY3jCF70dCQB8TSgNjbCVAC/8vai53GfMDrO2Emgwccf2pJqxct9ehpzG+MTw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="~/Content/AuctionCss/cssAuctionList.css" type="text/css" />
}
<div id="fullListPage">
    <div id="banner">
        卡片競標<br />
        Auction Card
    </div>
    <div class="row" id="mainContent">
        <div class="d-none d-md-block col-md-3 col-lg-2" id="divSort">
            <p class="sortTitle">
                <a href="" class="searchSort" data-keyword=""><span>所有商品</span></a>
            </p>
            <p class="sortTitle">
                <a href="" class="searchSort" data-keyword="寶可夢"><span>寶可夢 (Pokemon)</span></a>
            </p>
            <p class="sortTitle">
                <a href="" class="searchSort" data-keyword="遊戲王"><span>遊戲王 (Yu-Gi-Oh!)</span></a>
            </p>
            <p class="sortTitle">
                <a href="" class="searchSort" data-keyword="魔法風雲會"><span>魔法風雲會 (MTG)</span></a>
            </p>
            <p class="sortTitle">
                <a href="" class="searchSort" data-keyword="黑與白"><span>黑與白 (Weiß Schwarz)</span></a>
            </p>
            <p class="sortTitle">
                <a href="" class="searchSort" data-keyword="七龍珠"><span>七龍珠 (DragonBallHeroes)</span></a>
            </p>
            <p class="sortTitle">
                <a href="" class="searchSort" data-keyword="鋼彈大戰"><span>鋼彈大戰 (GUNDAM WAR)</span></a>
            </p>
            <p class="sortTitle">
                <a href="" class="searchSort" data-keyword="聖火降魔錄"><span>聖火降魔錄 (FE0)</span></a>
            </p>
            <p class="sortTitle">
                <a href="" class="searchSort" data-keyword="運動"><span>運動卡 (Sport)</span></a>
            </p>

        </div>
        <div class="col-12 col-sm-12 col-md-9 col-lg-10 container" id="divList">
            <div class="row">
                @foreach (var item in Model)
                {
                    int secondRemain = Convert.ToInt32((item.fEndTime - DateTime.Now).TotalSeconds);
                    int dayRemain = secondRemain / 86400;
                    secondRemain %= 86400;
                    int hourRemain = secondRemain / 3600;
                    secondRemain %= 3600;
                    int minuteRemain = secondRemain / 60;
                    string itemNameShort = item.fItemName;

                    <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
                        
                        <div class="cardBorder">
                            <a href="~/Auction/Item/@item.fItemId">
                                <div class="imgWrap">
                                    <img src="~/images/AuctionItemImages/@item.fPhoto0" class="cardImg" alt="..." style="width:100%;height:100%;object-fit: contain;object-position:center">
                                </div>
                                <div class="cardBody">
                                    <p class="pName">@item.fItemName</p>
                                    <p class="pMoney">$ @item.fMoneyNow 元</p>
                                    <p class="pTime"><i class="fa-solid fa-clock"></i> @dayRemain 天 @hourRemain 時 @minuteRemain 分</p>
                                </div>
                            </a>
                        </div>
                    </div>
                }
            </div>




        </div>
    </div>
</div>

@section scripts{
    <script>
        document.querySelectorAll('.cardBorder').forEach(function (dom) {
            dom.addEventListener('mouseover', function () {
                this.classList.add('cardSelect');
            });

            dom.addEventListener('mouseleave', function () {
                this.classList.remove('cardSelect');
            });

        });

        document.querySelectorAll('.searchSort').forEach(function (dom) {
            dom.addEventListener('click', function (event) {
                event.preventDefault();
                let keyword = this.dataset.keyword;

                let xhr = new XMLHttpRequest();
                xhr.addEventListener('load', function () {
                    let datas = xhr.response;
                    console.log(datas);
                });
                xhr.open('GET', '@Url.Content("~/Auction/QueryBySort/")' + keyword);
                xhr.send();
            })
        });
    </script>
    }
